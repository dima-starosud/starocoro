TODO
  * advance generator right before handling;
  * configurable yield handlers;
