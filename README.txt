TODO
  * advance generator right before handling;
